<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Termék módosítása: {{ azonosito }}</title>
</head>
<body>
    <h1>Termék módosítása: {{ azonosito }}</h1>
    <form method="POST" action="/edit/{{ azonosito }}" id="editForm">
        {% for field in mezok %}
            <div>
                <label for="{{ field }}">{{ field }}:</label>
                {% if field == 'Azonosító' %}
                    <input type="text" id="{{ field }}" name="{{ field }}" value="{{ row[field] }}" readonly>
                {% elif field in listak %}
                    <select id="{{ field }}" name="{{ field }}">
                        {% for option in listak[field] %}
                            <option value="{{ option }}" {% if option == row[field] %}selected{% endif %}>{{ option }}</option>
                        {% endfor %}
                    </select>
                {% else %}
                    <input type="text" id="{{ field }}" name="{{ field }}" value="{{ row[field] }}">
                {% endif %}
            </div>
        {% endfor %}
        <button type="submit">Mentés</button>
    </form>

    <script>
        // JavaScript a form elküldéséhez PUT kéréssel
        document.getElementById('editForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = {};
            {% for field in mezok %}
                formData['{{ field }}'] = document.getElementById('{{ field }}').value;
            {% endfor %}
            
            fetch('/edit/{{ azonosito }}', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (response.ok) {
                    alert('Adatok sikeresen mentve!');
                    window.location.href = '/data'; // Vissza a főoldalra vagy más URL-re
                } else {
                    return response.json().then(data => {
                        throw new Error(data.message || 'Hiba történt a mentés során.');
                    });
                }
            })
            .catch(error => {
                alert('Hiba: ' + error.message);
            });
        });
    </script>
</body>
</html>